# Что такое POE. Пример очень простой POE-программы

**POE** - portable multitasking and networking framework for any event loop - платформонезависимый фреймворк для создания многозадачных и сетевых событийно-ориентированных приложений на Perl.


## Ядро и сессии POE

Систему POE часто называют "маленькой операционной системой". Она имеет собственное ядро, процессы, возможности межпроцессного взаимодействия (IPC), драйвера.

Основными модулями POE являются <font color="#00aa00">POE::Kernel</font> и <font color="#00aa00">POE::Session</font>. Они подгружаются автоматически, при подключении модуля POE.

<font color="#00aa00">POE::Kernel - это ядро системы</font>. Ядро контролирует работу процессов, обеспечивает многозадачность системы. POE реализует невытесняющую многозадачность: все сессии выполняются в рамках одного процесса операционной системы, без использования потоков или создания дополнительных процессов. При этом, сессии отрабатываются по очереди. Пока не завершится работа текущей сессии, выполнение другой не начнется. Это важно учитывать, чтобы из-за ошибки в работе сессии не была заблокирована работа всего POE-приложения.

<font color="#00aa00">Сессия в POE - это эквивалент процессов в обычной операционной системе</font>. Каждую сессию можно рассматривать как самостоятельное приложение, которое имеет свой набор методов и свою абстрактную память. С помощью ядра сессии могут общаться между собой. Можно создавать "дочерние" сессии.

POE является событийной машиной. Вся работа этой системы направлена на получение информации о произошедших событиях, и обработку этих событий. При создании сессии, указывается список возможных событий и каждому из них назначается собственный обработчик.

Таким образом - ядро POE, сессии (как минимум одна) и список событийных обработчиков - это основа любой POE-системы. Без любого из этих компонентов работа системы становится невозможной.

Пример самой простой POE-программы:

```perl
#!/usr/bin/perl

use strict;
use warnings;

use POE;

POE::Session->create(
	'inline_states' => {
		'_start'    => sub {
			print "Session ", $_[SESSION]->ID, " has started.\n";
		},
		'_stop'     => sub {
			print "Session ", $_[SESSION]->ID, " has stopped.\n";
		},
	}
);

POE::Kernel->run;
exit;
```

Вывод:
<pre>% perl test_poe.pl
Session 2 has started.
Session 2 has stopped.
</pre>

В данном случае, мы просто создаем одну сессию, которая в начале работы должна выводить сообщение о старте, а при завершении работы - запись об остановке. И запускаем ядро, которое запускает сессию на выполнение .


